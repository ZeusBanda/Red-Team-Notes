# Post-Exploitation
## Network Enumeration
|Windows|Linux|
|---|---|
|netstat -na|netstat -natu|
|arp -a| ss -t state established|
|ipconfig /displaydns| arp -a|
|   | ip n|
## Firewall Enumeration
### Windows
#### netsh
```cmd
netsh advfirewall show allprofiles
```


## Account Enumeration
### Linux
#### Linux User Enumeration
```bash
cat /etc/passwd
```
```bash
cat /etc/passwd | cut -d: -f1 > users..txt
```
#### Linux Group Enumeration
```bash
cat /etc/groups
```
### Windows
#### List Local Users
```cmd
net user
```
#### List Local Groups
```cmd
net localgroup
```
#### List members of local admin group
```cmd
net localgroup administrators
```
#### Add a User
```cmd
net user zeus
```
#### Add user to the local admin group
```cmd
net localgroup administrators zeus /add
```
#### List Domain Users
```cmd
net user /domain
```
```cmd
net1.exe user /domain
```
#### List Domain Groups
```cmd
net group /domain
```
#### List all users in a group
```cmd
net group <group_name> /domain
```
#### List all users in the Domain Admin Group
```cmd
net group "Domain Admins" /domain
```
#### Add a user to Domain Admin group
```cmd
net group "Domain Admins" username /domain /add
```
#### Remove a user from a group
```cmd
net localgroup <group> <user> /del
```
#### Delete an account
```cmd
net user <user> /del
```

## FIle Enumeration
### Linux
#### SETUID/SETGID Files
```bash
find / -perm -4000 -o -2000 -ls 2>/dev/null
```
#### Writable Configuration Files
```bash
find /etc -perm -2
```
#### Readable Bash History
```bash
find /home -name .bash_history - perm -4 2>/dev/null
```
#### Potential Password Files
```bash
grep -Inri passw /etc/* 2>/dev/null
```

### Windows
#### Print file content
```cmd
type <file>
```
#### Look at Multiple FIles
```cmd
type *.txt
```
#### Display text one page at a time
```cmd
more <file>
```
#### Searching for a string within a file
```cmd
type <file> | find /i "<string>"
```
#### Search for regular expression
```cmd
type <file> | findstr <regex>
```
#### Find Hosts file
```cmd
dir /b /s <directory>\<file>
```
#### Find Unattend.xml,sysprep.inf,sysprep.xml
```cmd
dir /b /s C:\[unattend.xml,sysprep.inf,sysprep.xml]
```
#### GPP
```cmd
findstr /S cpassword %LOGONSERVER\sysvol\*.xml
```


## Registry Enumeration
### Read
```cmd
reg query <KeyName>
```
### Change a Key
```cmd
reg add <KeyName> /v <ValueName> /t <type> /d <data>
```
### Export Settings to a reg file
```cmd
reg export <KeyName> <filename.reg>
```
### Import Settings from a Reg File
```cmd
reg import <filename.reg>
```

## Environment Enumeration
### Windows
#### set - show all varriables
```cmd
set
```
#### set - show a variable
```cmd
set <variable>
```
#### set - view username
```cmd
set username
```
#### set - view psth
```cmd
set path
```